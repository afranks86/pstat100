<!DOCTYPE html>
<html lang="en"><head>
<script src="week2-tidy_files/libs/clipboard/clipboard.min.js"></script>
<script src="week2-tidy_files/libs/quarto-html/tabby.min.js"></script>
<script src="week2-tidy_files/libs/quarto-html/popper.min.js"></script>
<script src="week2-tidy_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="week2-tidy_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="week2-tidy_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="week2-tidy_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.40">

  <title>Data Science Concepts and Analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="week2-tidy_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="week2-tidy_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="week2-tidy_files/libs/revealjs/dist/theme/quarto-bbe7401fe57d4b791b917637bb662036.css">
  <link href="week2-tidy_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="week2-tidy_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="week2-tidy_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="week2-tidy_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="week2-tidy_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="week2-tidy_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Data Science Concepts and Analysis</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="announcements" class="slide level2">
<h2>Announcements</h2>
<ul>
<li>Homework 1 posted, due January 27
<ul>
<li>Can work with and submit with 1 partner</li>
</ul></li>
<li>Office Hours:
<ul>
<li>Utso: Friday, 3-5pm.</li>
<li>Yaxuan:
<ul>
<li>Wednesday, 11 - 12pm (Room 113, Building 434),</li>
<li>Friday 11 - 12pm (Zoom)</li>
</ul></li>
<li>Yuxi:
<ul>
<li>11am-12pm on Monday in PHELP 2524.</li>
</ul></li>
<li>Franks: Thursday 1-2pm, Zoom: https://tinyurl.com/stat100oh</li>
</ul></li>
</ul>
<p>See Canvas for details</p>
</section>
<section id="this-week" class="slide level2">
<h2>This week</h2>
<ul>
<li><strong>Tabular data</strong>
<ul>
<li>Many ways to structure a dataset</li>
<li>Few organizational constraints ‘in the wild’</li>
</ul></li>
<li><strong>Principles of tidy data: matching semantics with structure</strong>
<ul>
<li>Data semantics: observations and variables</li>
<li>Tabular structure: rows and columns</li>
<li>The tidy standard</li>
<li>Common messes</li>
<li>Tidying operations</li>
</ul></li>
<li><strong>Transforming data frames</strong>
<ul>
<li>Subsetting (slicing and filtering)</li>
<li>Derived variables</li>
<li>Aggregation and summary statistics</li>
</ul></li>
</ul>
</section>
<section id="tabular-data" class="slide level2">
<h2>Tabular data</h2>
<ul>
<li>Many possible layouts for tabular data</li>
<li>‘Real’ datasets have few organizational constraints</li>
</ul>
<p>Most data are stored in tables, but <strong>there are always multiple possible tabular layouts for the same underlying data</strong>.</p>
</section>
<section id="reading-data" class="slide level2">
<h2>Reading data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a>mammal_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/allison1976.csv"</span>)</span>
<span id="cb1-2"><a href=""></a>mammal_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 62 × 11
   species          body_wt brain_wt non_dreaming dreaming total_sleep life_span
   &lt;chr&gt;              &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 Africanelephant  6.65e+3   5712           NA       NA           3.3      38.6
 2 Africangiantpou… 1   e+0      6.6          6.3      2           8.3       4.5
 3 ArcticFox        3.38e+0     44.5         NA       NA          12.5      14  
 4 Arcticgroundsqu… 9.2 e-1      5.7         NA       NA          16.5      NA  
 5 Asianelephant    2.55e+3   4603            2.1      1.8         3.9      69  
 6 Baboon           1.06e+1    180.           9.1      0.7         9.8      27  
 7 Bigbrownbat      2.3 e-2      0.3         15.8      3.9        19.7      19  
 8 Braziliantapir   1.6 e+2    169            5.2      1           6.2      30.4
 9 Cat              3.3 e+0     25.6         10.9      3.6        14.5      28  
10 Chimpanzee       5.22e+1    440            8.3      1.4         9.7      50  
# ℹ 52 more rows
# ℹ 4 more variables: gestation &lt;dbl&gt;, predation &lt;dbl&gt;, exposure &lt;dbl&gt;,
#   danger &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="piping" class="slide level2">
<h2>Piping</h2>
<ul>
<li><p>Pipes are used to chain a sequence of multiple operations.</p></li>
<li><p>Makes code more readable and concise</p></li>
<li><p>The pipe operator takes the output of one function and passes it as the first argument to the next function.</p></li>
<li><p><code>%&gt;%</code> in <code>tidyverse</code> syntax or <code>|&gt;</code></p></li>
<li><p>There are subtle differences between them. I will try to stick to <code>|&gt;</code></p></li>
</ul>
</section>
<section id="piping-1" class="slide level2">
<h2>Piping</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="do">## Piping approach</span></span>
<span id="cb3-2"><a href=""></a>mammal_data <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href=""></a>  <span class="fu">filter</span>(<span class="fu">startsWith</span>(species, <span class="st">"African"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href=""></a>  <span class="fu">select</span>(species, body_wt, brain_wt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  species                body_wt brain_wt
  &lt;chr&gt;                    &lt;dbl&gt;    &lt;dbl&gt;
1 Africanelephant           6654   5712  
2 Africangiantpouchedrat       1      6.6</code></pre>
</div>
</div>
<p>is the same as…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="do">## same as</span></span>
<span id="cb5-2"><a href=""></a>filtered_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(<span class="at">.data=</span>mammal_data, </span>
<span id="cb5-3"><a href=""></a>                        <span class="fu">startsWith</span>(species, <span class="st">"African"</span>))</span>
<span id="cb5-4"><a href=""></a><span class="fu">select</span>(filtered_data, species, body_wt, brain_wt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  species                body_wt brain_wt
  &lt;chr&gt;                    &lt;dbl&gt;    &lt;dbl&gt;
1 Africanelephant           6654   5712  
2 Africangiantpouchedrat       1      6.6</code></pre>
</div>
</div>
<p>is the same as…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="do">## Same as...</span></span>
<span id="cb7-2"><a href=""></a>mammal_data[<span class="fu">startsWith</span>(mammal_data<span class="sc">$</span>species, <span class="st">"African"</span>), <span class="fu">c</span>(<span class="st">"species"</span>, <span class="st">"body_wt"</span>, <span class="st">"brain_wt"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  species                body_wt brain_wt
  &lt;chr&gt;                    &lt;dbl&gt;    &lt;dbl&gt;
1 Africanelephant           6654   5712  
2 Africangiantpouchedrat       1      6.6</code></pre>
</div>
</div>
</section>
<section>
<section id="why-tidy" class="title-slide slide level1 center">
<h1>Why tidy?</h1>
<ul>
<li><p>Many possible layouts for tabular data</p></li>
<li><p>‘Real’ datasets have few organizational constraints</p></li>
</ul>
<p>Most data are stored in tables, but <strong>there are always multiple possible tabular layouts for the same underlying data</strong>.</p>
</section>
<section id="mammal-data-long-layouts" class="slide level2">
<h2>Mammal data: long layouts</h2>
<p>Below is the Allison 1976 mammal brain-body weight dataset from week 1 lecture shown in two ‘long’ layouts:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a><span class="co"># import brain and body weights</span></span>
<span id="cb9-2"><a href=""></a>mammal1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/allison1976.csv'</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb9-3"><a href=""></a>mammal1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 62 × 3
   species                 body_wt brain_wt
   &lt;chr&gt;                     &lt;dbl&gt;    &lt;dbl&gt;
 1 Africanelephant        6654       5712  
 2 Africangiantpouchedrat    1          6.6
 3 ArcticFox                 3.38      44.5
 4 Arcticgroundsquirrel      0.92       5.7
 5 Asianelephant          2547       4603  
 6 Baboon                   10.6      180. 
 7 Bigbrownbat               0.023      0.3
 8 Braziliantapir          160        169  
 9 Cat                       3.3       25.6
10 Chimpanzee               52.2      440  
# ℹ 52 more rows</code></pre>
</div>
</div>
</section>
<section id="longer-layout" class="slide level2">
<h2>Longer layout</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  species                measurement  weight
  &lt;chr&gt;                  &lt;chr&gt;         &lt;dbl&gt;
1 Africanelephant        body_wt     6654   
2 Africanelephant        brain_wt    5712   
3 Africangiantpouchedrat body_wt        1   
4 Africangiantpouchedrat brain_wt       6.6 
5 ArcticFox              body_wt        3.38</code></pre>
</div>
</div>
</section>
<section id="wide-format" class="slide level2">
<h2>Wide format</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 63
  measurement Africanelephant Africangiantpouchedrat ArcticFox
  &lt;chr&gt;                 &lt;dbl&gt;                  &lt;dbl&gt;     &lt;dbl&gt;
1 body_wt                6654                    1        3.38
2 brain_wt               5712                    6.6     44.5 
# ℹ 59 more variables: Arcticgroundsquirrel &lt;dbl&gt;, Asianelephant &lt;dbl&gt;,
#   Baboon &lt;dbl&gt;, Bigbrownbat &lt;dbl&gt;, Braziliantapir &lt;dbl&gt;, Cat &lt;dbl&gt;,
#   Chimpanzee &lt;dbl&gt;, Chinchilla &lt;dbl&gt;, Cow &lt;dbl&gt;, Deserthedgehog &lt;dbl&gt;,
#   Donkey &lt;dbl&gt;, EasternAmericanmole &lt;dbl&gt;, Echidna &lt;dbl&gt;,
#   Europeanhedgehog &lt;dbl&gt;, Galago &lt;dbl&gt;, Genet &lt;dbl&gt;, Giantarmadillo &lt;dbl&gt;,
#   Giraffe &lt;dbl&gt;, Goat &lt;dbl&gt;, Goldenhamster &lt;dbl&gt;, Gorilla &lt;dbl&gt;,
#   Grayseal &lt;dbl&gt;, Graywolf &lt;dbl&gt;, Groundsquirrel &lt;dbl&gt;, Guineapig &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="gdp-growth-data-wide-layout" class="slide level2">
<h2>GDP growth data: wide layout</h2>
<p>Here’s another example: World Bank data on annual GDP growth for 264 countries from 1961 – 2019. The raw layout is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a>gdp1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/annual_growth.csv'</span>)</span>
<span id="cb13-2"><a href=""></a><span class="fu">head</span>(gdp1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 61
  `Country Name` `Country Code` `1961` `1962` `1963` `1964` `1965` `1966` `1967`
  &lt;chr&gt;          &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 Aruba          ABW                NA     NA     NA     NA     NA     NA     NA
2 Afghanistan    AFG                NA     NA     NA     NA     NA     NA     NA
3 Angola         AGO                NA     NA     NA     NA     NA     NA     NA
4 Albania        ALB                NA     NA     NA     NA     NA     NA     NA
5 Andorra        AND                NA     NA     NA     NA     NA     NA     NA
6 Arab World     ARB                NA     NA     NA     NA     NA     NA     NA
# ℹ 52 more variables: `1968` &lt;dbl&gt;, `1969` &lt;dbl&gt;, `1970` &lt;dbl&gt;, `1971` &lt;dbl&gt;,
#   `1972` &lt;dbl&gt;, `1973` &lt;dbl&gt;, `1974` &lt;dbl&gt;, `1975` &lt;dbl&gt;, `1976` &lt;dbl&gt;,
#   `1977` &lt;dbl&gt;, `1978` &lt;dbl&gt;, `1979` &lt;dbl&gt;, `1980` &lt;dbl&gt;, `1981` &lt;dbl&gt;,
#   `1982` &lt;dbl&gt;, `1983` &lt;dbl&gt;, `1984` &lt;dbl&gt;, `1985` &lt;dbl&gt;, `1986` &lt;dbl&gt;,
#   `1987` &lt;dbl&gt;, `1988` &lt;dbl&gt;, `1989` &lt;dbl&gt;, `1990` &lt;dbl&gt;, `1991` &lt;dbl&gt;,
#   `1992` &lt;dbl&gt;, `1993` &lt;dbl&gt;, `1994` &lt;dbl&gt;, `1995` &lt;dbl&gt;, `1996` &lt;dbl&gt;,
#   `1997` &lt;dbl&gt;, `1998` &lt;dbl&gt;, `1999` &lt;dbl&gt;, `2000` &lt;dbl&gt;, `2001` &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="gdp-growth-data-long-layout" class="slide level2">
<h2>GDP growth data: long layout</h2>
<p>Here’s an alternative layout for the annual GDP growth data:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  `Country Name` `Country Code` year    GDP
  &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt; &lt;dbl&gt;
1 Afghanistan    AFG            1961   NA  
2 Albania        ALB            1961   NA  
3 Algeria        DZA            1961  -13.6
4 American Samoa ASM            1961   NA  
5 Andorra        AND            1961   NA  </code></pre>
</div>
</div>
</section>
<section id="sb-weather-data-long-layouts" class="slide level2">
<h2>SB weather data: long layouts</h2>
<p>A third example: daily minimum and maximum temperatures recorded at Santa Barbara Municipal Airport from January 2021 through March 2021.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a>weather1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/sb_weather.csv'</span>)</span>
<span id="cb16-2"><a href=""></a><span class="co"># convert to date format specifying month/day/year format</span></span>
<span id="cb16-3"><a href=""></a>weather1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 88 × 5
   STATION     NAME                                   DATE       TMAX  TMIN
   &lt;chr&gt;       &lt;chr&gt;                                  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 1/1/2021     65    37
 2 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 1/2/2021     62    38
 3 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 1/3/2021     60    42
 4 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 1/4/2021     72    43
 5 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 1/5/2021     61    40
 6 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 1/6/2021     71    39
 7 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 1/7/2021     73    38
 8 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 1/8/2021     79    36
 9 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 1/9/2021     71    39
10 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 1/10/2021    67    37
# ℹ 78 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a>weather1 <span class="ot">&lt;-</span> weather1 <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">mdy</span>(DATE)) <span class="do">## from the lubridate package</span></span>
<span id="cb18-2"><a href=""></a>weather1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 88 × 5
   STATION     NAME                                   DATE        TMAX  TMIN
   &lt;chr&gt;       &lt;chr&gt;                                  &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 2021-01-01    65    37
 2 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 2021-01-02    62    38
 3 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 2021-01-03    60    42
 4 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 2021-01-04    72    43
 5 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 2021-01-05    61    40
 6 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 2021-01-06    71    39
 7 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 2021-01-07    73    38
 8 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 2021-01-08    79    36
 9 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 2021-01-09    71    39
10 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 2021-01-10    67    37
# ℹ 78 more rows</code></pre>
</div>
</div>
</section>
<section id="sb-weather-data-long-layouts-1" class="slide level2">
<h2>SB weather data: long layouts</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 88 × 5
     DAY MONTH  YEAR  TMAX  TMIN
   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1     1     1  2021    65    37
 2     2     1  2021    62    38
 3     3     1  2021    60    42
 4     4     1  2021    72    43
 5     5     1  2021    61    40
 6     6     1  2021    71    39
 7     7     1  2021    73    38
 8     8     1  2021    79    36
 9     9     1  2021    71    39
10    10     1  2021    67    37
# ℹ 78 more rows</code></pre>
</div>
</div>
</section>
<section id="sb-weather-data-wide-days" class="slide level2">
<h2>SB weather data: wide days</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 36
  STATION     NAME   MONTH  YEAR Type    `1`   `2`   `3`   `4`   `5`   `6`   `7`
  &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 USW00023190 SANTA…     1  2021 TMAX     65    62    60    72    61    71    73
2 USW00023190 SANTA…     1  2021 TMIN     37    38    42    43    40    39    38
3 USW00023190 SANTA…     2  2021 TMAX     66    67    69    63    66    68    60
4 USW00023190 SANTA…     2  2021 TMIN     45    40    44    37    38    38    38
5 USW00023190 SANTA…     3  2021 TMAX     68    66    59    62    67    69    60
6 USW00023190 SANTA…     3  2021 TMIN     37    36    36    37    39    43    47
# ℹ 24 more variables: `8` &lt;dbl&gt;, `9` &lt;dbl&gt;, `10` &lt;dbl&gt;, `11` &lt;dbl&gt;,
#   `12` &lt;dbl&gt;, `13` &lt;dbl&gt;, `14` &lt;dbl&gt;, `15` &lt;dbl&gt;, `16` &lt;dbl&gt;, `17` &lt;dbl&gt;,
#   `18` &lt;dbl&gt;, `19` &lt;dbl&gt;, `20` &lt;dbl&gt;, `21` &lt;dbl&gt;, `22` &lt;dbl&gt;, `23` &lt;dbl&gt;,
#   `24` &lt;dbl&gt;, `25` &lt;dbl&gt;, `26` &lt;dbl&gt;, `27` &lt;dbl&gt;, `28` &lt;dbl&gt;, `29` &lt;dbl&gt;,
#   `30` &lt;dbl&gt;, `31` &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="un-development-data-multiple-tables" class="slide level2">
<h2>UN development data: multiple tables</h2>
<p>A final example: United Nations country development data organized into different tables according to variable type.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a>undev1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/hdi3.csv'</span>, <span class="at">na =</span> <span class="st">'..'</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>hdi_rank)</span>
<span id="cb22-2"><a href=""></a></span>
<span id="cb22-3"><a href=""></a>undev2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/hdi2.csv'</span>, <span class="at">na =</span> <span class="st">'..'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-4"><a href=""></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(<span class="fu">c</span>(<span class="st">'hdi_rank'</span>, <span class="st">'maternal_mortality'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here is a table of population measurements:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a><span class="fu">head</span>(undev1, <span class="at">n=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  country     total_pop urban_pct_pop pop_under5 pop_15to64 pop_over65
  &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
1 Norway            5.4          82.6        0.3        3.5        0.9
2 Ireland           4.9          63.4        0.3        3.2        0.7
3 Switzerland       8.6          73.8        0.4        5.7        1.6</code></pre>
</div>
</div>
<p>And here is a table of a few gender-related variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href=""></a><span class="fu">head</span>(undev2, <span class="at">n=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  country     gender_inequality parliament_pct_women labor_participation_women
  &lt;chr&gt;                   &lt;dbl&gt;                &lt;dbl&gt;                     &lt;dbl&gt;
1 Norway                  0.045                 40.8                      60.4
2 Ireland                 0.093                 24.3                      56  
3 Switzerland             0.025                 38.6                      62.9
# ℹ 1 more variable: labor_participation_men &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="un-development-data-one-table" class="slide level2">
<h2>UN development data: one table</h2>
<p>Here are both tables merged by country:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 189 × 10
   country              total_pop urban_pct_pop pop_under5 pop_15to64 pop_over65
   &lt;chr&gt;                    &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1 Norway                     5.4          82.6        0.3        3.5        0.9
 2 Ireland                    4.9          63.4        0.3        3.2        0.7
 3 Switzerland                8.6          73.8        0.4        5.7        1.6
 4 Hong Kong, China (S…       7.4         100          0.3        5.2        1.3
 5 Iceland                    0.3          93.9        0          0.2        0.1
 6 Germany                   83.5          77.4        4         54         18  
 7 Sweden                    10            87.7        0.6        6.2        2  
 8 Australia                 25.2          86.1        1.7       16.3        4  
 9 Netherlands               17.1          91.9        0.9       11          3.4
10 Denmark                    5.8          88          0.3        3.7        1.2
# ℹ 179 more rows
# ℹ 4 more variables: gender_inequality &lt;dbl&gt;, parliament_pct_women &lt;dbl&gt;,
#   labor_participation_women &lt;dbl&gt;, labor_participation_men &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="a-better-glimpse" class="slide level2">
<h2>A better glimpse</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href=""></a><span class="fu">glimpse</span>(undev_combined1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 189
Columns: 10
$ country                   &lt;chr&gt; "Norway", "Ireland", "Switzerland", "Hong Ko…
$ total_pop                 &lt;dbl&gt; 5.4, 4.9, 8.6, 7.4, 0.3, 83.5, 10.0, 25.2, 1…
$ urban_pct_pop             &lt;dbl&gt; 82.6, 63.4, 73.8, 100.0, 93.9, 77.4, 87.7, 8…
$ pop_under5                &lt;dbl&gt; 0.3, 0.3, 0.4, 0.3, 0.0, 4.0, 0.6, 1.7, 0.9,…
$ pop_15to64                &lt;dbl&gt; 3.5, 3.2, 5.7, 5.2, 0.2, 54.0, 6.2, 16.3, 11…
$ pop_over65                &lt;dbl&gt; 0.9, 0.7, 1.6, 1.3, 0.1, 18.0, 2.0, 4.0, 3.4…
$ gender_inequality         &lt;dbl&gt; 0.045, 0.093, 0.025, NA, 0.058, 0.084, 0.039…
$ parliament_pct_women      &lt;dbl&gt; 40.8, 24.3, 38.6, NA, 38.1, 31.6, 47.3, 36.6…
$ labor_participation_women &lt;dbl&gt; 60.4, 56.0, 62.9, 54.0, 70.8, 55.3, 61.4, 60…
$ labor_participation_men   &lt;dbl&gt; 67.2, 68.4, 73.8, 67.5, 79.2, 66.6, 67.8, 70…</code></pre>
</div>
</div>
</section>
<section id="un-development-data-one-longer-table" class="slide level2">
<h2>UN development data: one (longer) table</h2>
<p>And here is another arrangement of the merged table:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,780 × 5
   country gender_variable     gender_value population_variable population_value
   &lt;chr&gt;   &lt;chr&gt;                      &lt;dbl&gt; &lt;chr&gt;                          &lt;dbl&gt;
 1 Norway  gender_inequality          0.045 total_pop                        5.4
 2 Norway  gender_inequality          0.045 urban_pct_pop                   82.6
 3 Norway  gender_inequality          0.045 pop_under5                       0.3
 4 Norway  gender_inequality          0.045 pop_15to64                       3.5
 5 Norway  gender_inequality          0.045 pop_over65                       0.9
 6 Norway  parliament_pct_wom…       40.8   total_pop                        5.4
 7 Norway  parliament_pct_wom…       40.8   urban_pct_pop                   82.6
 8 Norway  parliament_pct_wom…       40.8   pop_under5                       0.3
 9 Norway  parliament_pct_wom…       40.8   pop_15to64                       3.5
10 Norway  parliament_pct_wom…       40.8   pop_over65                       0.9
# ℹ 3,770 more rows</code></pre>
</div>
</div>
</section>
<section id="many-layouts" class="slide level2">
<h2>Many layouts</h2>
<p><strong>Pause and reflect</strong></p>
<p>Return to one of the examples and review the different layouts.</p>
<ul>
<li><p>If you had to pick one layout, which would you choose?</p></li>
<li><p>Why would you choose that one?</p>
<ul>
<li>Aesthetic preference?</li>
<li>“Just makes sense this way”?</li>
<li>“This way is better because…”?</li>
</ul></li>
<li><p>Can you envision advantages or disadvantages to different layouts?</p></li>
</ul>
</section>
<section id="few-organizational-constraints" class="slide level2">
<h2>Few organizational constraints</h2>
<p>It’s surprisingly difficult to articulate reasons why one layout might be preferable to another.</p>
<p>Possibly for this reason, most data are stored in a layout that made intuitive sense to someone responsible for data management or collection at some point in time.</p>
<ul>
<li><p>Usually the choice of layout isn’t principled</p></li>
<li><p>Idiosyncratic: two people are likely to make different choices</p></li>
</ul>
<p>As a result:</p>
<ul>
<li><p>Few widely used conventions</p></li>
<li><p>Lots of variability ‘in the wild’</p></li>
<li><p>Datasets are often organized in bizarre ways</p></li>
</ul>
</section>
<section id="consequences-for-the-data-scientist" class="slide level2">
<h2>Consequences for the data scientist</h2>
<p>Because of the wide range of possible layouts for a dataset, and the variety of choices that are made about how to store data, <strong>data scientists are constantly faced with determining how best to reorganize datasets in a way that facilitates exploration and analysis.</strong></p>
<p>Broadly, this involves two interdependent choices:</p>
<ul>
<li><em>Choice of <strong>representation</strong>: how to encode information.</em>
<ul>
<li>Example: parse dates as ‘MM/DD/YYYY’ (one variable) or ‘MM’, ‘DD’, ‘YYYY’ (three variables)?</li>
<li>Example: use values 1, 2, 3 or ‘low’, ‘med’, ‘high’?</li>
<li>Example: name variables ‘question1’, ‘question2’, …, or ‘age’, ‘income’, …?</li>
</ul></li>
<li><em>Choice of <strong>form</strong>: how to display information</em>
<ul>
<li>Example: wide table or long table?</li>
<li>Example: one table or many?</li>
</ul></li>
</ul>
</section>
<section id="remedy-the-tidy-data-standard" class="slide level2 scrollable">
<h2>Remedy: the tidy data standard</h2>
<p>Instead of addressing these challenges – choice of form and representation – anew every single time, it is immensely helpful to have a set of organizational principles to standardize the process of rearranging data.</p>
<p>The <strong>tidy data standard</strong> is a principled way of organizing data values. It has two main advantages:</p>
<ol type="1">
<li>Facilitates workflow by establishing a consistent dataset structure.</li>
<li>Principles are designed to make transformation, exploration, visualization, and modeling easy.</li>
</ol>
<p>This is a pretty intuitive idea. Many (most?) other things are easier when they’re thoughtfully organized.</p>
</section>
<section id="principles-of-tidy-data" class="slide level2">
<h2>Principles of tidy data</h2>
<ul>
<li><strong>Tidy data matches semantics with structure</strong>
<ul>
<li>Data semantics: observations, variables, units</li>
<li>Tabular structure: rows and columns</li>
<li>The tidy data standard</li>
<li>Common messes</li>
<li>Tidying operations</li>
</ul></li>
</ul>
</section>
<section id="matching-semantics-with-structure" class="slide level2">
<h2>Matching semantics with structure</h2>
<blockquote>
<p>“Tidying your data means storing it in a consistent form that matches the semantics of the dataset with the way it is stored. In brief, when your data is tidy, each column is a variable, and each row is an observation. Tidy data is important because the consistent structure lets you focus your struggle on questions about the data, not fighting to get the data into the right form for different functions.” <em>Wickham and Grolemund, R for Data Science, 2017.</em></p>
</blockquote>
</section>
<section id="matching-semantics-with-structure-1" class="slide level2">
<h2>Matching semantics with structure</h2>
<p>A dataset is a collection of values.</p>
<ul>
<li>semantics: meaning
<ul>
<li><em>data semantics</em> refers to the meaning of each value</li>
</ul></li>
<li>structure: form
<ul>
<li><em>data structure</em> refers to how values are arranged</li>
</ul></li>
</ul>
<p>The <strong>tidy standard</strong>: data semantics <span class="math inline">\(\longleftrightarrow\)</span> data structure</p>
</section>
<section id="semantics-units-variables-and-observations" class="slide level2">
<h2>Semantics: units, variables, and observations</h2>
<p><em>Data semantics</em> refers to the meaning of values. To introduce some general vocabulary, each value is</p>
<ul>
<li><p>an <strong>observation</strong></p></li>
<li><p>of a <strong>variable</strong></p></li>
<li><p>taken on a <strong>unit</strong>.</p></li>
</ul>
<p>To be precise:</p>
<ul>
<li><p>An <strong>observational unit</strong> is the entity measured.</p></li>
<li><p>A <strong>variable</strong> is an attribute measured on each unit.</p></li>
<li><p>An <strong>observation</strong> is a collection of measurements taken on one unit.</p></li>
</ul>
</section>
<section id="identifying-units-variables-and-observations" class="slide level2">
<h2>Identifying units, variables, and observations</h2>
<p>Let’s do an example. In the GDP growth data:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Term</th>
<th>Definition</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Observational units</td>
<td>Entity measured</td>
<td>Countries</td>
</tr>
<tr class="even">
<td>Variables</td>
<td>Attributes measured</td>
<td>Year, GDP growth</td>
</tr>
<tr class="odd">
<td>Observations</td>
<td>Set of measurements per unit</td>
<td>Annual records</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a><span class="co"># third record</span></span>
<span id="cb31-2"><a href=""></a>gdp2[<span class="dv">3</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  `Country Name` `Country Code` year    GDP
  &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt; &lt;dbl&gt;
1 Algeria        DZA            1961  -13.6</code></pre>
</div>
</div>
<p>So, below, -13.605441 (variable) in 1961 (variable) is a record (observation) for Algeria (unit).</p>
</section>
<section id="identifying-units-variables-and-observations-1" class="slide level2 smaller">
<h2>Identifying units, variables, and observations</h2>
<p>In the weather data:</p>
<table class="caption-top">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Term</th>
<th>Definition</th>
<th>Instance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Observational unit</td>
<td>Entity measured</td>
<td>SB airport weather station (location)</td>
</tr>
<tr class="even">
<td>Variables</td>
<td>Attributes measured</td>
<td>Min temp, max temp, date, station info</td>
</tr>
<tr class="odd">
<td>Observations</td>
<td>Set of measurements per unit</td>
<td>Daily records</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href=""></a><span class="co"># first record</span></span>
<span id="cb33-2"><a href=""></a>weather1[<span class="dv">1</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  STATION     NAME                                   DATE        TMAX  TMIN
  &lt;chr&gt;       &lt;chr&gt;                                  &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, CA US 2021-01-01    65    37</code></pre>
</div>
</div>
<p>For example: 65 degrees Farenheit is the maximum temperature (one variable) recorded on a day (one observation) at the SB airport weather station (unit).</p>
</section>
<section id="data-structure" class="slide level2">
<h2>Data structure</h2>
<p><em>Data structure</em> refers to the form in which it is stored.</p>
<p>In this context, that means a tabular arrangement of a dataset comprising:</p>
<ul>
<li><p>rows</p></li>
<li><p>columns</p></li>
</ul>
<p>As we saw, there are multiple structures available to represent any dataset.</p>
</section>
<section id="the-tidy-standard" class="slide level2 scrollable">
<h2>The tidy standard</h2>
<p>The tidy standard consists in matching semantics and structure.</p>
<p>We can now make that precise. A dataset conforming to the <strong>tidy standard</strong> is organized so that:</p>
<ol type="1">
<li>Each variable is a column.</li>
<li>Each observation is a row.</li>
<li>Each table contains measurements on only one type of observational unit.</li>
</ol>
<p><img src="figures/tidy-layout.png" style="height:200px"></p>
</section>
<section id="tidy-or-messy" class="slide level2">
<h2>Tidy or messy?</h2>
<p>Let’s revisit some of our examples of multiple layouts, starting with <code>gdp1</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href=""></a><span class="fu">head</span>(gdp1, <span class="at">n=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 61
  `Country Name` `Country Code` `1961` `1962` `1963` `1964` `1965` `1966` `1967`
  &lt;chr&gt;          &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 Aruba          ABW                NA     NA     NA     NA     NA     NA     NA
2 Afghanistan    AFG                NA     NA     NA     NA     NA     NA     NA
3 Angola         AGO                NA     NA     NA     NA     NA     NA     NA
# ℹ 52 more variables: `1968` &lt;dbl&gt;, `1969` &lt;dbl&gt;, `1970` &lt;dbl&gt;, `1971` &lt;dbl&gt;,
#   `1972` &lt;dbl&gt;, `1973` &lt;dbl&gt;, `1974` &lt;dbl&gt;, `1975` &lt;dbl&gt;, `1976` &lt;dbl&gt;,
#   `1977` &lt;dbl&gt;, `1978` &lt;dbl&gt;, `1979` &lt;dbl&gt;, `1980` &lt;dbl&gt;, `1981` &lt;dbl&gt;,
#   `1982` &lt;dbl&gt;, `1983` &lt;dbl&gt;, `1984` &lt;dbl&gt;, `1985` &lt;dbl&gt;, `1986` &lt;dbl&gt;,
#   `1987` &lt;dbl&gt;, `1988` &lt;dbl&gt;, `1989` &lt;dbl&gt;, `1990` &lt;dbl&gt;, `1991` &lt;dbl&gt;,
#   `1992` &lt;dbl&gt;, `1993` &lt;dbl&gt;, `1994` &lt;dbl&gt;, `1995` &lt;dbl&gt;, `1996` &lt;dbl&gt;,
#   `1997` &lt;dbl&gt;, `1998` &lt;dbl&gt;, `1999` &lt;dbl&gt;, `2000` &lt;dbl&gt;, `2001` &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="tidy-or-messy-1" class="slide level2 smaller">
<h2>Tidy or messy?</h2>
<p>We can compare the semantics and structure for alignment:</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Semantics</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observations</td>
<td style="text-align: left;">Annual records</td>
</tr>
<tr class="even">
<td style="text-align: left;">Variables</td>
<td style="text-align: left;">GDP growth and year</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Observational units</td>
<td style="text-align: left;">Countries</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Structure</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Rows</td>
<td style="text-align: left;">Countries</td>
</tr>
<tr class="even">
<td style="text-align: left;">Columns</td>
<td style="text-align: left;">Value of year</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tables</td>
<td style="text-align: left;">Just one</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="fragment">
<p>Rules 1 and 2 are violated, since column names are values (of year), not variables. <em>Not tidy</em>.</p>
</div>
</section>
<section id="tidy-or-messy-2" class="slide level2">
<h2>Tidy or messy?</h2>
<p>In <code>gdp2</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href=""></a><span class="fu">head</span>(gdp2, <span class="at">n=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  `Country Name` `Country Code` year    GDP
  &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt; &lt;dbl&gt;
1 Afghanistan    AFG            1961   NA  
2 Albania        ALB            1961   NA  
3 Algeria        DZA            1961  -13.6
4 American Samoa ASM            1961   NA  </code></pre>
</div>
</div>
</section>
<section id="tidy-or-messy-3" class="slide level2 smaller">
<h2>Tidy or messy?</h2>
<p>Comparison of semantics and structure:</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Semantics</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observations</td>
<td style="text-align: left;">Annual records</td>
</tr>
<tr class="even">
<td style="text-align: left;">Variables</td>
<td style="text-align: left;">GDP growth and year</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Observational units</td>
<td style="text-align: left;">Countries</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Structure</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Rows</td>
<td style="text-align: left;">Annual records</td>
</tr>
<tr class="even">
<td style="text-align: left;">Columns</td>
<td style="text-align: left;">GDP growth and year</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tables</td>
<td style="text-align: left;">Just one</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="fragment">
<p>All three rules are met: rows are observations, columns are variables, and there’s one unit type and one table. <em>Tidy</em>.</p>
</div>
</section>
<section id="tidy-or-messy-4" class="slide level2 scrollable">
<h2>Tidy or messy?</h2>
<div class="cell" data-slideshow="{&quot;slide_type&quot;:&quot;fragment&quot;}" data-tags="[]">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href=""></a><span class="fu">head</span>(weather2, <span class="at">n=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 8
  STATION     NAME                      DATE        TMAX  TMIN   DAY MONTH  YEAR
  &lt;chr&gt;       &lt;chr&gt;                     &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1 USW00023190 SANTA BARBARA MUNICIPAL … 2021-01-01    65    37     1     1  2021
2 USW00023190 SANTA BARBARA MUNICIPAL … 2021-01-02    62    38     2     1  2021
3 USW00023190 SANTA BARBARA MUNICIPAL … 2021-01-03    60    42     3     1  2021
4 USW00023190 SANTA BARBARA MUNICIPAL … 2021-01-04    72    43     4     1  2021</code></pre>
</div>
</div>
<p>Try this one on your own. Then compare with your neighbor.</p>
<ol type="1">
<li>Identify the observations and variables</li>
<li>What are the observational units?</li>
</ol>
</section>
<section id="tidy-or-messy-5" class="slide level2">
<h2>Tidy or messy?</h2>
<p>In <code>undev1</code> and <code>undev2</code>:</p>
<div class="fragment">
<div class="cell" data-slideshow="{&quot;slide_type&quot;:&quot;fragment&quot;}" data-tags="[]">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href=""></a><span class="fu">head</span>(undev1, <span class="at">n=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  country     total_pop urban_pct_pop pop_under5 pop_15to64 pop_over65
  &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
1 Norway            5.4          82.6        0.3        3.5        0.9
2 Ireland           4.9          63.4        0.3        3.2        0.7
3 Switzerland       8.6          73.8        0.4        5.7        1.6</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell" data-slideshow="{&quot;slide_type&quot;:&quot;fragment&quot;}" data-tags="[]">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href=""></a><span class="fu">head</span>(undev2, <span class="at">n=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  country     gender_inequality parliament_pct_women labor_participation_women
  &lt;chr&gt;                   &lt;dbl&gt;                &lt;dbl&gt;                     &lt;dbl&gt;
1 Norway                  0.045                 40.8                      60.4
2 Ireland                 0.093                 24.3                      56  
3 Switzerland             0.025                 38.6                      62.9
# ℹ 1 more variable: labor_participation_men &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Here there are multiple tables. To discuss:</p>
<ul>
<li>Are the observational units the same or different?</li>
<li>Based on your answer above, is the data tidy or not?</li>
</ul>
</div>
</section>
<section id="common-messes" class="slide level2">
<h2>Common messes</h2>
<p>These examples illustrate some of the most common kinds of messiness:</p>
<ul>
<li><em>Columns are values, not variables</em>
<ul>
<li>GDP data <code>gdp1</code>: columns are 1961, 1962, …</li>
</ul></li>
<li><em>Multiple variables are stored in one column</em>
<ul>
<li>Mammal data <code>mammal2</code>: weight column contains both body and brain weights</li>
</ul></li>
<li><em>Variables or values are stored in rows and columns</em>
<ul>
<li>Weather data <code>weather3</code>: date values are stored in rows and columns, each column contains both min and max temperatures</li>
</ul></li>
<li><em>Measurements on one type of observational unit are divided into multiple tables.</em>
<ul>
<li>UN development data: <code>undev1</code> stores population variables; <code>undev2</code> stores gender-related variables.</li>
</ul></li>
</ul>
</section>
<section id="tidying-operations" class="slide level2">
<h2>Tidying operations</h2>
<p>These common messes can be cleaned up by some simple operations:</p>
<ul>
<li><code>pivot_longer</code>
<ul>
<li>reshape a dataframe from wide to long format</li>
</ul></li>
<li><code>pivot_wider</code>
<ul>
<li>reshape a dataframe from long to wide format</li>
</ul></li>
<li><em>joins</em>
<ul>
<li>combine two dataframes row-wise by matching the values of certain columns</li>
</ul></li>
</ul>
</section>
<section id="pivot_longer" class="slide level2">
<h2><code>pivot_longer</code></h2>
<p>Pivoting resolves the problem of having values stored as columns (common mess 1).</p>
<center>
<img data-src="figures/tidy-melt.png" style="width:80.0%">
</center>
</section>
<section id="pivot_longer-1" class="slide level2">
<h2><code>pivot_longer</code></h2>
<p>To illustrate with <code>gdp1</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href=""></a><span class="fu">head</span>(gdp1, <span class="at">n=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 61
  `Country Name` `Country Code` `1961` `1962` `1963` `1964` `1965` `1966` `1967`
  &lt;chr&gt;          &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 Aruba          ABW                NA     NA     NA     NA     NA     NA     NA
2 Afghanistan    AFG                NA     NA     NA     NA     NA     NA     NA
3 Angola         AGO                NA     NA     NA     NA     NA     NA     NA
# ℹ 52 more variables: `1968` &lt;dbl&gt;, `1969` &lt;dbl&gt;, `1970` &lt;dbl&gt;, `1971` &lt;dbl&gt;,
#   `1972` &lt;dbl&gt;, `1973` &lt;dbl&gt;, `1974` &lt;dbl&gt;, `1975` &lt;dbl&gt;, `1976` &lt;dbl&gt;,
#   `1977` &lt;dbl&gt;, `1978` &lt;dbl&gt;, `1979` &lt;dbl&gt;, `1980` &lt;dbl&gt;, `1981` &lt;dbl&gt;,
#   `1982` &lt;dbl&gt;, `1983` &lt;dbl&gt;, `1984` &lt;dbl&gt;, `1985` &lt;dbl&gt;, `1986` &lt;dbl&gt;,
#   `1987` &lt;dbl&gt;, `1988` &lt;dbl&gt;, `1989` &lt;dbl&gt;, `1990` &lt;dbl&gt;, `1991` &lt;dbl&gt;,
#   `1992` &lt;dbl&gt;, `1993` &lt;dbl&gt;, `1994` &lt;dbl&gt;, `1995` &lt;dbl&gt;, `1996` &lt;dbl&gt;,
#   `1997` &lt;dbl&gt;, `1998` &lt;dbl&gt;, `1999` &lt;dbl&gt;, `2000` &lt;dbl&gt;, `2001` &lt;dbl&gt;, …</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href=""></a>gdp1 <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">61</span>,</span>
<span id="cb47-2"><a href=""></a>                     <span class="at">names_to=</span><span class="st">"Year"</span>,</span>
<span id="cb47-3"><a href=""></a>                     <span class="at">values_to=</span><span class="st">"GDP"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb47-4"><a href=""></a>  <span class="fu">arrange</span>(Year, <span class="st">`</span><span class="at">Country Name</span><span class="st">`</span>) <span class="co"># sort by year first then country</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15,576 × 4
   `Country Name`      `Country Code` Year     GDP
   &lt;chr&gt;               &lt;chr&gt;          &lt;chr&gt;  &lt;dbl&gt;
 1 Afghanistan         AFG            1961   NA   
 2 Albania             ALB            1961   NA   
 3 Algeria             DZA            1961  -13.6 
 4 American Samoa      ASM            1961   NA   
 5 Andorra             AND            1961   NA   
 6 Angola              AGO            1961   NA   
 7 Antigua and Barbuda ATG            1961   NA   
 8 Arab World          ARB            1961   NA   
 9 Argentina           ARG            1961    5.43
10 Armenia             ARM            1961   NA   
# ℹ 15,566 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="pivoting-to-a-wider-format" class="slide level2">
<h2>Pivoting to a wider format</h2>
<p>Pivoting to a wider format resolves the issue of having multiple variables stored in one column (common mess 2).</p>
<center>
<img data-src="figures/tidy-pivot.png" style="width:80.0%">
</center>
</section>
<section id="pivot-wider" class="slide level2">
<h2>Pivot wider</h2>
<p>For example, the <code>mammal2</code> layout can be put in tidier form with <code>pivot_longer</code>:</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href=""></a><span class="fu">head</span>(mammal2, <span class="at">n=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  species                measurement weight
  &lt;chr&gt;                  &lt;chr&gt;        &lt;dbl&gt;
1 Africanelephant        body_wt       6654
2 Africanelephant        brain_wt      5712
3 Africangiantpouchedrat body_wt          1</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href=""></a>mammal2 <span class="sc">|&gt;</span> <span class="fu">pivot_wider</span>(</span>
<span id="cb51-2"><a href=""></a>    <span class="at">names_from =</span> <span class="st">'measurement'</span>, <span class="co"># which variable(s) do you want to send to new column names?</span></span>
<span id="cb51-3"><a href=""></a>    <span class="at">values_from =</span> <span class="st">'weight'</span> <span class="co"># which variable(s) do you want to use to populate the new columns?</span></span>
<span id="cb51-4"><a href=""></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 62 × 3
   species                 body_wt brain_wt
   &lt;chr&gt;                     &lt;dbl&gt;    &lt;dbl&gt;
 1 Africanelephant        6654       5712  
 2 Africangiantpouchedrat    1          6.6
 3 ArcticFox                 3.38      44.5
 4 Arcticgroundsquirrel      0.92       5.7
 5 Asianelephant          2547       4603  
 6 Baboon                   10.6      180. 
 7 Bigbrownbat               0.023      0.3
 8 Braziliantapir          160        169  
 9 Cat                       3.3       25.6
10 Chimpanzee               52.2      440  
# ℹ 52 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="pivot-longer-and-wider" class="slide level2">
<h2>Pivot longer and wider</h2>
<p>Common mess 3 is a combination of messes 1 and 2: values or variables are stored in both rows and columns. Pivoting and melting in sequence can usually fix this. <code>weather3</code> illustrates this issue:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href=""></a>weather3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 36
  STATION     NAME   MONTH  YEAR Type    `1`   `2`   `3`   `4`   `5`   `6`   `7`
  &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 USW00023190 SANTA…     1  2021 TMAX     65    62    60    72    61    71    73
2 USW00023190 SANTA…     1  2021 TMIN     37    38    42    43    40    39    38
3 USW00023190 SANTA…     2  2021 TMAX     66    67    69    63    66    68    60
4 USW00023190 SANTA…     2  2021 TMIN     45    40    44    37    38    38    38
5 USW00023190 SANTA…     3  2021 TMAX     68    66    59    62    67    69    60
6 USW00023190 SANTA…     3  2021 TMIN     37    36    36    37    39    43    47
# ℹ 24 more variables: `8` &lt;dbl&gt;, `9` &lt;dbl&gt;, `10` &lt;dbl&gt;, `11` &lt;dbl&gt;,
#   `12` &lt;dbl&gt;, `13` &lt;dbl&gt;, `14` &lt;dbl&gt;, `15` &lt;dbl&gt;, `16` &lt;dbl&gt;, `17` &lt;dbl&gt;,
#   `18` &lt;dbl&gt;, `19` &lt;dbl&gt;, `20` &lt;dbl&gt;, `21` &lt;dbl&gt;, `22` &lt;dbl&gt;, `23` &lt;dbl&gt;,
#   `24` &lt;dbl&gt;, `25` &lt;dbl&gt;, `26` &lt;dbl&gt;, `27` &lt;dbl&gt;, `28` &lt;dbl&gt;, `29` &lt;dbl&gt;,
#   `30` &lt;dbl&gt;, `31` &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="pivot-longer-and-wider-1" class="slide level2">
<h2>Pivot longer and wider</h2>
<p>First <strong>Pivot Longer</strong>…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href=""></a><span class="do">## First move date columns into a variable</span></span>
<span id="cb55-2"><a href=""></a>weather3_long <span class="ot">&lt;-</span> weather3 <span class="sc">|&gt;</span> </span>
<span id="cb55-3"><a href=""></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">36</span>,</span>
<span id="cb55-4"><a href=""></a>    <span class="at">names_to =</span> <span class="st">'day'</span>,</span>
<span id="cb55-5"><a href=""></a>    <span class="at">values_to =</span> <span class="st">'temp'</span></span>
<span id="cb55-6"><a href=""></a>  )</span>
<span id="cb55-7"><a href=""></a>weather3_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 186 × 7
   STATION     NAME                                MONTH  YEAR Type  day    temp
   &lt;chr&gt;       &lt;chr&gt;                               &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;
 1 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 TMAX  1        65
 2 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 TMAX  2        62
 3 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 TMAX  3        60
 4 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 TMAX  4        72
 5 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 TMAX  5        61
 6 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 TMAX  6        71
 7 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 TMAX  7        73
 8 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 TMAX  8        79
 9 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 TMAX  9        71
10 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 TMAX  10       67
# ℹ 176 more rows</code></pre>
</div>
</div>
</section>
<section id="pivot-longer-and-wider-2" class="slide level2">
<h2>Pivot longer and wider</h2>
<p>Then <code>pivot_wider</code>…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href=""></a><span class="do">## First move date columns into a variable</span></span>
<span id="cb57-2"><a href=""></a>weather3_tidy <span class="ot">&lt;-</span> weather3_long <span class="sc">|&gt;</span> </span>
<span id="cb57-3"><a href=""></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Type, <span class="at">values_from =</span> temp)</span>
<span id="cb57-4"><a href=""></a>weather3_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 93 × 7
   STATION     NAME                                MONTH  YEAR day    TMAX  TMIN
   &lt;chr&gt;       &lt;chr&gt;                               &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 1        65    37
 2 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 2        62    38
 3 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 3        60    42
 4 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 4        72    43
 5 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 5        61    40
 6 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 6        71    39
 7 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 7        73    38
 8 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 8        79    36
 9 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 9        71    39
10 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 10       67    37
# ℹ 83 more rows</code></pre>
</div>
</div>
</section>
<section id="pivot-longer-and-wider-3" class="slide level2">
<h2>Pivot longer and wider</h2>
<p><strong>All in one chunk</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href=""></a><span class="do">## First move date columns into a variable</span></span>
<span id="cb59-2"><a href=""></a>weather3 <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a href=""></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">36</span>,</span>
<span id="cb59-4"><a href=""></a>               <span class="at">names_to =</span> <span class="st">'day'</span>,</span>
<span id="cb59-5"><a href=""></a>               <span class="at">values_to =</span> <span class="st">'temp'</span></span>
<span id="cb59-6"><a href=""></a>               ) <span class="sc">|&gt;</span> </span>
<span id="cb59-7"><a href=""></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Type, </span>
<span id="cb59-8"><a href=""></a>              <span class="at">values_from =</span> temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 93 × 7
   STATION     NAME                                MONTH  YEAR day    TMAX  TMIN
   &lt;chr&gt;       &lt;chr&gt;                               &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 1        65    37
 2 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 2        62    38
 3 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 3        60    42
 4 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 4        72    43
 5 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 5        61    40
 6 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 6        71    39
 7 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 7        73    38
 8 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 8        79    36
 9 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 9        71    39
10 USW00023190 SANTA BARBARA MUNICIPAL AIRPORT, C…     1  2021 10       67    37
# ℹ 83 more rows</code></pre>
</div>
</div>
</section>
<section id="pivoting" class="slide level2">
<h2>Pivoting</h2>
<center>
<img data-src="figures/tidyr-pivoting.gif">
</center>
</section>
<section id="joins" class="slide level2">
<h2>Joins</h2>
<p>Joining resolves the issue of storing observations or variables on one unit type in multiple tables (mess 4). The basic idea is to combine by matching rows.</p>
<center>
<img src="figures/join-diagram.png" style="height:300px">
</center>
<p>However, there are a number of different joining rules (corresponding to SQL joins).</p>
</section>
<section id="join" class="slide level2">
<h2>Join</h2>
<p>The code below combines columns in each table by matching rows based on country.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href=""></a><span class="fu">inner_join</span>(undev1, undev2, <span class="at">by =</span> <span class="st">'country'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 189 × 10
   country              total_pop urban_pct_pop pop_under5 pop_15to64 pop_over65
   &lt;chr&gt;                    &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1 Norway                     5.4          82.6        0.3        3.5        0.9
 2 Ireland                    4.9          63.4        0.3        3.2        0.7
 3 Switzerland                8.6          73.8        0.4        5.7        1.6
 4 Hong Kong, China (S…       7.4         100          0.3        5.2        1.3
 5 Iceland                    0.3          93.9        0          0.2        0.1
 6 Germany                   83.5          77.4        4         54         18  
 7 Sweden                    10            87.7        0.6        6.2        2  
 8 Australia                 25.2          86.1        1.7       16.3        4  
 9 Netherlands               17.1          91.9        0.9       11          3.4
10 Denmark                    5.8          88          0.3        3.7        1.2
# ℹ 179 more rows
# ℹ 4 more variables: gender_inequality &lt;dbl&gt;, parliament_pct_women &lt;dbl&gt;,
#   labor_participation_women &lt;dbl&gt;, labor_participation_men &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="joins-1" class="slide level2">
<h2>Joins</h2>
<p>There are various rules for exactly how to join, but the general syntactical procedure to merge dataframes <code>df1</code> and <code>df2</code> is this.</p>
<ul>
<li>Specify <strong>keys</strong>: the shared columns to use for matching rows of <code>df1</code> with rows of <code>df2</code>.
<ul>
<li>for example, joining on <code>date</code> will align rows in <code>df2</code> with rows of <code>df1</code> that have the same value for <code>date</code></li>
</ul></li>
<li>Specify a <strong>rule</strong> for which rows to return after merging</li>
</ul>
</section>
<section id="inner-join" class="slide level2">
<h2>Inner join</h2>
<center>
<img data-src="figures/inner-join.gif">
</center>
</section>
<section id="other-joins" class="slide level2">
<h2>Other joins</h2>
<ul>
<li>Inner join: keep only rows in both</li>
<li>Left join: keep all left rows</li>
<li>Right join: keep all right rows</li>
<li>Outer join: keep all rows from both</li>
</ul>
</section>
<section id="tidying-facilitates-transformation" class="slide level2 scrollable">
<h2>Tidying facilitates transformation</h2>
<p><em>Why use the tidy standard? Wouldn’t any system of organization do just as well?</em></p>
<p>The tidy standard has three main advantages:</p>
<ol type="1">
<li><p>Having a consistent system of organization makes it easier to focus on analysis and exploration.</p></li>
<li><p>Transformation of tidy data is especially natural in most computing environments due to vectorized operations.</p></li>
<li><p>Many tools for exploration, visualization, and modeling are designed to work with tidy data inputs.</p></li>
</ol>
</section>
<section id="visualization" class="slide level2">
<h2>Visualization</h2>
<p>Plotting libraries often operate in such a way that tidy data is easier to plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href=""></a>weather1 <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>DATE, <span class="at">y=</span>TMAX)) <span class="sc">+</span> </span>
<span id="cb63-2"><a href=""></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week2-tidy_files/figure-revealjs/unnamed-chunk-36-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exceptions" class="slide level2">
<h2>Exceptions</h2>
<p>There will be situations where you’ll need to deviate from the tidy format for various purposes.</p>
<p>Sometimes, plotting and table construction require reshaping data into non-tidy formats, for example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href=""></a>weather4 <span class="ot">&lt;-</span> weather1 <span class="sc">|&gt;</span> </span>
<span id="cb64-2"><a href=""></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"TMIN"</span>, <span class="st">"TMAX"</span>),</span>
<span id="cb64-3"><a href=""></a>               <span class="at">values_to=</span><span class="st">"Temp"</span>, </span>
<span id="cb64-4"><a href=""></a>               <span class="at">names_to=</span><span class="st">"Min/Max"</span>)</span>
<span id="cb64-5"><a href=""></a></span>
<span id="cb64-6"><a href=""></a>weather4 <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>DATE, <span class="at">y=</span>Temp, <span class="at">col=</span><span class="st">`</span><span class="at">Min/Max</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb64-7"><a href=""></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week2-tidy_files/figure-revealjs/unnamed-chunk-37-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exceptions-1" class="slide level2">
<h2>Exceptions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href=""></a>mammal2 <span class="sc">|&gt;</span> <span class="fu">filter</span>(species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Rabbit"</span>, <span class="st">"Raccoon"</span>, <span class="st">"Sheep"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb65-2"><a href=""></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb65-3"><a href=""></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y=</span>weight, <span class="at">x=</span>species, <span class="at">fill=</span>measurement), </span>
<span id="cb65-4"><a href=""></a>           <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb65-5"><a href=""></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week2-tidy_files/figure-revealjs/unnamed-chunk-38-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tidy-data-is-not-easy-to-look-at" class="slide level2">
<h2>Tidy data is not easy to look at</h2>
<ul>
<li><p>Tidy data is optimized for computation and visualization</p></li>
<li><p>Most data in a spreadsheet won’t be tidy!</p></li>
<li><p>When presenting tables, tidy is usually not optimal</p></li>
</ul>
</section>
<section id="review-the-tidy-data-format" class="slide level2 scrollable">
<h2>Review: The Tidy Data Format</h2>
<p>The tidy data format is defined by three key principles:</p>
<ol type="1">
<li>Each variable forms a column.</li>
<li>Each observation forms a row.</li>
<li>Each type of observational unit forms a table.</li>
</ol>
</section>
<section id="the-tidy-format" class="slide level2">
<h2>The tidy format</h2>
<p>Tidy data typically has these characteristics:</p>
<ul>
<li>Each cell contains a single value.</li>
<li>Column headers are variable names, not values.</li>
<li>Variables are stored in columns, not rows.</li>
<li>Different types of variables are stored in different tables.</li>
</ul>
</section>
<section id="tidy-data-format" class="slide level2">
<h2>Tidy Data Format</h2>
<p><strong>Advantages:</strong></p>
<ul>
<li>Consistent format</li>
<li>Easy visualization with <code>ggplot2</code></li>
<li>Simplifies data manipulation.
<ul>
<li>Tools like dplyr and tidyr work efficiently with tidy data, making data transformation more straightforward.</li>
</ul></li>
<li>Facilitates analysis
<ul>
<li>Many statistical and machine learning functions in R expect data in a tidy format.</li>
</ul></li>
</ul>
</section>
<section id="tidy-data-format-1" class="slide level2">
<h2>Tidy Data Format</h2>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Learning curve</li>
<li>Storage inefficiency</li>
<li>Not always intuitive
<ul>
<li>For some types of data or analyses, a wide format might be more natural</li>
<li>Not good for examining by eye (e.g.&nbsp;in a spreadsheet)</li>
</ul></li>
</ul>
</section>
<section id="review" class="slide level2">
<h2>Review</h2>
<ul>
<li>In tidy data, rows and columns correspond to observations and variables.
<ul>
<li>This provides a standard dataset structure that facilitates exploration and analysis.</li>
<li>Many datasets are not stored in this format.</li>
</ul></li>
<li>Transformation operations are a lot easier with tidy data.
<ul>
<li>Due in part to the way tools in pandas are designed.</li>
<li>The goal of lab 1 is to learn these operations.</li>
</ul></li>
<li>There are situations where non-tidy data is useful.
<ul>
<li>In PSTAT100, these will usually arise in plotting and tabulation tasks.</li>
</ul></li>
</ul>
</section>
<section id="up-next" class="slide level2">
<h2>Up next</h2>
<ul>
<li>Slicing rows by column</li>
<li>Filtering rows by logical conditions</li>
<li>Defining new variables from scratch or by operations on existing variables (<code>mutate</code>)</li>
<li>Aggregations (min, mean, max, etc.)</li>
</ul>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="week2-tidy_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="week2-tidy_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="week2-tidy_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="week2-tidy_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="week2-tidy_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="week2-tidy_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="week2-tidy_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="week2-tidy_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="week2-tidy_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="week2-tidy_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="week2-tidy_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>